generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Application {
  id              String   @id @default(cuid())
  discordId       String
  discordName     String
  discordAvatar   String?
  status          String   @default("pending") // pending, approved, denied, revision
  answers         Answer[]
  denialReason    String?
  revisionReason  String?  // Reason for requesting revision
  revisionQuestionIds String[] // Question IDs that need revision
  reviewedBy      String?  // Discord username of reviewer
  reviewedById    String?  // Discord ID of reviewer
  reviewedAt      DateTime?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model Answer {
  id            String      @id @default(cuid())
  applicationId String
  application   Application @relation(fields: [applicationId], references: [id], onDelete: Cascade)
  questionId    String
  question      Question    @relation(fields: [questionId], references: [id])
  textAnswer    String?
  audioUrl      String?
  createdAt     DateTime    @default(now())
}

model Question {
  id          String   @id @default(cuid())
  text        String
  type        String   // text, textarea, audio
  required    Boolean  @default(true)
  order       Int      @default(0)
  answers     Answer[]
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}
